\hypertarget{main_8c}{}\doxysection{src/main.c File Reference}
\label{main_8c}\index{src/main.c@{src/main.c}}


Main file of Super\+Derpy engine.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$getopt.\+h$>$}\newline
{\ttfamily \#include $<$locale.\+h$>$}\newline
{\ttfamily \#include $<$signal.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}gamestates/menu.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gamestates/loading.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gamestates/about.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gamestates/intro.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gamestates/map.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gamestates/level.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gamestates/pause.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gamestates/disclaimer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}config.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{main_8c_a6f4cfa63173a94a303439c98b0529180}{P\+R\+E\+L\+O\+A\+D\+\_\+\+S\+T\+A\+TE}}(state,  name)
\begin{DoxyCompactList}\small\item\em Macro for preloading gamestate. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{main_8c_a914c1023fa675d05317561a3ba4270e9}{U\+N\+L\+O\+A\+D\+\_\+\+S\+T\+A\+TE}}(state,  name)
\begin{DoxyCompactList}\small\item\em Macro for unloading gamestate. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{main_8c_a8ee7a9c7e83c9bd4b69f5e96f368c7fb}{L\+O\+A\+D\+\_\+\+S\+T\+A\+TE}}(state,  name)
\begin{DoxyCompactList}\small\item\em Macro for loading gamestate. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_ad177e8b9a44bacebfe10168f6b6fb983}\label{main_8c_ad177e8b9a44bacebfe10168f6b6fb983}} 
\#define \mbox{\hyperlink{main_8c_ad177e8b9a44bacebfe10168f6b6fb983}{K\+E\+Y\+D\+O\+W\+N\+\_\+\+S\+T\+A\+TE}}(state,  name)~else if (game.\+gamestate==state) \{ if (name \#\# \+\_\+\+Keydown(\&game, \&ev)) break; \}
\begin{DoxyCompactList}\small\item\em Macro for sending keydown events to gamestate. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{main_8c_a2073d7fa9facf2f65d7198e159714d28}{D\+R\+A\+W\+\_\+\+S\+T\+A\+TE}}(state,  name)
\begin{DoxyCompactList}\small\item\em Macro for drawing active gamestate. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{main_8c_a377e5ef6571dce5dc2ddbff14df69932}{L\+O\+G\+I\+C\+\_\+\+S\+T\+A\+TE}}(state,  name)
\begin{DoxyCompactList}\small\item\em Macro for invoking logic function of active gamestate. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{main_8c_a84252a86aaf291a45b6318fe80a767fa}{P\+A\+U\+S\+E\+\_\+\+S\+T\+A\+TE}}(state,  name)
\begin{DoxyCompactList}\small\item\em Macro for invoking pause function of active gamestate. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{main_8c_af38a995c235fecc1427c040f3bffda7e}{R\+E\+S\+U\+M\+E\+\_\+\+S\+T\+A\+TE}}(state,  name)
\begin{DoxyCompactList}\small\item\em Macro for invoking resume function of active gamestate. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
char $\ast$ \mbox{\hyperlink{main_8c_a3c3512cfd72e3078ed970085f31a7b40}{Get\+Data\+File\+Path}} (char $\ast$filename)
\begin{DoxyCompactList}\small\item\em Tries to figure out where are our assets currently stored. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8c_a83e9560a39a8b6beea953f69553dd28b}{Print\+Console}} (struct \mbox{\hyperlink{structGame}{Game}} $\ast$game, char $\ast$format,...)
\begin{DoxyCompactList}\small\item\em Print some message on game console. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_a3a03870a3158c22e10b22d60822c190a}\label{main_8c_a3a03870a3158c22e10b22d60822c190a}} 
void \mbox{\hyperlink{main_8c_a3a03870a3158c22e10b22d60822c190a}{Draw\+Console}} (struct \mbox{\hyperlink{structGame}{Game}} $\ast$game)
\begin{DoxyCompactList}\small\item\em Draws console bitmap on screen. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_afd10ce18ae3e601a9c462e2bd552ed32}\label{main_8c_afd10ce18ae3e601a9c462e2bd552ed32}} 
void \mbox{\hyperlink{main_8c_afd10ce18ae3e601a9c462e2bd552ed32}{Preload\+Game\+State}} (struct \mbox{\hyperlink{structGame}{Game}} $\ast$game, void($\ast$progress)(struct \mbox{\hyperlink{structGame}{Game}} $\ast$, float))
\begin{DoxyCompactList}\small\item\em Preloads gamestate set in game-\/$>$loadstate. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_afbbdeccc0adc5c3a0c84461f51a45a5b}\label{main_8c_afbbdeccc0adc5c3a0c84461f51a45a5b}} 
void \mbox{\hyperlink{main_8c_afbbdeccc0adc5c3a0c84461f51a45a5b}{Unload\+Game\+State}} (struct \mbox{\hyperlink{structGame}{Game}} $\ast$game)
\begin{DoxyCompactList}\small\item\em Unloads gamestate set in game-\/$>$gamestate. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_afe84ca1b0107fe689f9d2987d83caea0}\label{main_8c_afe84ca1b0107fe689f9d2987d83caea0}} 
void \mbox{\hyperlink{main_8c_afe84ca1b0107fe689f9d2987d83caea0}{Load\+Game\+State}} (struct \mbox{\hyperlink{structGame}{Game}} $\ast$game)
\begin{DoxyCompactList}\small\item\em Loads gamestate set in game-\/$>$loadstate. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_aba8768911068b399b4118452eb3959ec}\label{main_8c_aba8768911068b399b4118452eb3959ec}} 
void \mbox{\hyperlink{main_8c_aba8768911068b399b4118452eb3959ec}{Draw\+Game\+State}} (struct \mbox{\hyperlink{structGame}{Game}} $\ast$game)
\begin{DoxyCompactList}\small\item\em Draws frame from current gamestate. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_ad0546784746e89712b06e405ad907bb9}\label{main_8c_ad0546784746e89712b06e405ad907bb9}} 
void \mbox{\hyperlink{main_8c_ad0546784746e89712b06e405ad907bb9}{Logic\+Game\+State}} (struct \mbox{\hyperlink{structGame}{Game}} $\ast$game)
\begin{DoxyCompactList}\small\item\em Processes logic of current gamestate. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_acec4517002cf3ba62b607d3f4ebe20e8}\label{main_8c_acec4517002cf3ba62b607d3f4ebe20e8}} 
void \mbox{\hyperlink{main_8c_acec4517002cf3ba62b607d3f4ebe20e8}{Pause\+Game\+State}} (struct \mbox{\hyperlink{structGame}{Game}} $\ast$game)
\begin{DoxyCompactList}\small\item\em Pauses gamestate set in game-\/$>$loadstate. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_a132daa46a6e55c1508badea4d38b6fc6}\label{main_8c_a132daa46a6e55c1508badea4d38b6fc6}} 
void \mbox{\hyperlink{main_8c_a132daa46a6e55c1508badea4d38b6fc6}{Resume\+Game\+State}} (struct \mbox{\hyperlink{structGame}{Game}} $\ast$game)
\begin{DoxyCompactList}\small\item\em Resumes gamestate set in game-\/$>$loadstate. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_a9b39a4855e329ac4613b2ff881c86e9b}\label{main_8c_a9b39a4855e329ac4613b2ff881c86e9b}} 
void \mbox{\hyperlink{main_8c_a9b39a4855e329ac4613b2ff881c86e9b}{Fade\+Game\+State}} (struct \mbox{\hyperlink{structGame}{Game}} $\ast$game, bool in)
\begin{DoxyCompactList}\small\item\em Displays fade in or fade out animation on current gamestate. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_a95f035fc3dfd7397ae24243d156c8195}\label{main_8c_a95f035fc3dfd7397ae24243d156c8195}} 
void \mbox{\hyperlink{main_8c_a95f035fc3dfd7397ae24243d156c8195}{Scale\+Bitmap}} (A\+L\+L\+E\+G\+R\+O\+\_\+\+B\+I\+T\+M\+AP $\ast$source, int width, int height)
\begin{DoxyCompactList}\small\item\em Scales bitmap using software linear filtering method to current target. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_a83bf17fca7535cabf55e8fcffbf80c7c}\label{main_8c_a83bf17fca7535cabf55e8fcffbf80c7c}} 
A\+L\+L\+E\+G\+R\+O\+\_\+\+B\+I\+T\+M\+AP $\ast$ \mbox{\hyperlink{main_8c_a83bf17fca7535cabf55e8fcffbf80c7c}{Load\+Scaled\+Bitmap}} (char $\ast$filename, int width, int height)
\begin{DoxyCompactList}\small\item\em Loads bitmap into memory and scales it with software linear filtering. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_a7026a8094d3ddca6f7a69b8b489515e7}\label{main_8c_a7026a8094d3ddca6f7a69b8b489515e7}} 
void \mbox{\hyperlink{main_8c_a7026a8094d3ddca6f7a69b8b489515e7}{Setup\+Viewport}} (struct \mbox{\hyperlink{structGame}{Game}} $\ast$game)
\begin{DoxyCompactList}\small\item\em Setups letterbox viewport if necessary. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_ab0af27461c4e23c088670da5e6a971ef}\label{main_8c_ab0af27461c4e23c088670da5e6a971ef}} 
int \mbox{\hyperlink{main_8c_ab0af27461c4e23c088670da5e6a971ef}{Shared\+\_\+\+Load}} (struct \mbox{\hyperlink{structGame}{Game}} $\ast$game)
\begin{DoxyCompactList}\small\item\em Load shared resources. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_af9010ebe7fc75fbd882a9a8bf7b32d0c}\label{main_8c_af9010ebe7fc75fbd882a9a8bf7b32d0c}} 
void \mbox{\hyperlink{main_8c_af9010ebe7fc75fbd882a9a8bf7b32d0c}{Shared\+\_\+\+Unload}} (struct \mbox{\hyperlink{structGame}{Game}} $\ast$game)
\begin{DoxyCompactList}\small\item\em Unload shared resources. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8c_aee04879d8e98ca91e54503418babd3a5}\label{main_8c_aee04879d8e98ca91e54503418babd3a5}} 
void {\bfseries derp} (int sig)
\item 
\mbox{\Hypertarget{main_8c_a3c04138a5bfe5d72780bb7e82a18e627}\label{main_8c_a3c04138a5bfe5d72780bb7e82a18e627}} 
int {\bfseries main} (int argc, char $\ast$$\ast$argv)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Main file of Super\+Derpy engine. 

Contains basic functions shared by all views. 

\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{main_8c_a2073d7fa9facf2f65d7198e159714d28}\label{main_8c_a2073d7fa9facf2f65d7198e159714d28}} 
\index{main.c@{main.c}!DRAW\_STATE@{DRAW\_STATE}}
\index{DRAW\_STATE@{DRAW\_STATE}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{DRAW\_STATE}{DRAW\_STATE}}
{\footnotesize\ttfamily \#define D\+R\+A\+W\+\_\+\+S\+T\+A\+TE(\begin{DoxyParamCaption}\item[{}]{state,  }\item[{}]{name }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{        \textcolor{keywordflow}{case} state:\(\backslash\)}
\DoxyCodeLine{        name \#\# \_Draw(game); \textcolor{keywordflow}{break};}

\end{DoxyCode}


Macro for drawing active gamestate. 

\mbox{\Hypertarget{main_8c_a8ee7a9c7e83c9bd4b69f5e96f368c7fb}\label{main_8c_a8ee7a9c7e83c9bd4b69f5e96f368c7fb}} 
\index{main.c@{main.c}!LOAD\_STATE@{LOAD\_STATE}}
\index{LOAD\_STATE@{LOAD\_STATE}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{LOAD\_STATE}{LOAD\_STATE}}
{\footnotesize\ttfamily \#define L\+O\+A\+D\+\_\+\+S\+T\+A\+TE(\begin{DoxyParamCaption}\item[{}]{state,  }\item[{}]{name }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{        \textcolor{keywordflow}{case} state:\(\backslash\)}
\DoxyCodeLine{        PrintConsole(game, \textcolor{stringliteral}{"Load \%s..."}, \#state); name \#\# \_Load(game); \textcolor{keywordflow}{break};}

\end{DoxyCode}


Macro for loading gamestate. 

\mbox{\hyperlink{structLoading}{Loading}} of state means setting it as active and running it. \mbox{\Hypertarget{main_8c_a377e5ef6571dce5dc2ddbff14df69932}\label{main_8c_a377e5ef6571dce5dc2ddbff14df69932}} 
\index{main.c@{main.c}!LOGIC\_STATE@{LOGIC\_STATE}}
\index{LOGIC\_STATE@{LOGIC\_STATE}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{LOGIC\_STATE}{LOGIC\_STATE}}
{\footnotesize\ttfamily \#define L\+O\+G\+I\+C\+\_\+\+S\+T\+A\+TE(\begin{DoxyParamCaption}\item[{}]{state,  }\item[{}]{name }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{        \textcolor{keywordflow}{case} state:\(\backslash\)}
\DoxyCodeLine{        name \#\# \_Logic(game); \textcolor{keywordflow}{break};}

\end{DoxyCode}


Macro for invoking logic function of active gamestate. 

\mbox{\Hypertarget{main_8c_a84252a86aaf291a45b6318fe80a767fa}\label{main_8c_a84252a86aaf291a45b6318fe80a767fa}} 
\index{main.c@{main.c}!PAUSE\_STATE@{PAUSE\_STATE}}
\index{PAUSE\_STATE@{PAUSE\_STATE}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{PAUSE\_STATE}{PAUSE\_STATE}}
{\footnotesize\ttfamily \#define P\+A\+U\+S\+E\+\_\+\+S\+T\+A\+TE(\begin{DoxyParamCaption}\item[{}]{state,  }\item[{}]{name }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{        \textcolor{keywordflow}{case} state:\(\backslash\)}
\DoxyCodeLine{        PrintConsole(game, \textcolor{stringliteral}{"Pause \%s..."}, \#state); name \#\# \_Pause(game); \textcolor{keywordflow}{break};}

\end{DoxyCode}


Macro for invoking pause function of active gamestate. 

\mbox{\Hypertarget{main_8c_a6f4cfa63173a94a303439c98b0529180}\label{main_8c_a6f4cfa63173a94a303439c98b0529180}} 
\index{main.c@{main.c}!PRELOAD\_STATE@{PRELOAD\_STATE}}
\index{PRELOAD\_STATE@{PRELOAD\_STATE}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{PRELOAD\_STATE}{PRELOAD\_STATE}}
{\footnotesize\ttfamily \#define P\+R\+E\+L\+O\+A\+D\+\_\+\+S\+T\+A\+TE(\begin{DoxyParamCaption}\item[{}]{state,  }\item[{}]{name }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{        \textcolor{keywordflow}{case} state:\(\backslash\)}
\DoxyCodeLine{        PrintConsole(game, \textcolor{stringliteral}{"Preload \%s..."}, \#state); \mbox{\hyperlink{main_8c_a3a03870a3158c22e10b22d60822c190a}{DrawConsole}}(game); al\_flip\_display(); name \#\# \_Preload(game, progress); \textcolor{keywordflow}{break};}

\end{DoxyCode}


Macro for preloading gamestate. 

Preloading of state happens when loading screen is displayed. \mbox{\Hypertarget{main_8c_af38a995c235fecc1427c040f3bffda7e}\label{main_8c_af38a995c235fecc1427c040f3bffda7e}} 
\index{main.c@{main.c}!RESUME\_STATE@{RESUME\_STATE}}
\index{RESUME\_STATE@{RESUME\_STATE}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{RESUME\_STATE}{RESUME\_STATE}}
{\footnotesize\ttfamily \#define R\+E\+S\+U\+M\+E\+\_\+\+S\+T\+A\+TE(\begin{DoxyParamCaption}\item[{}]{state,  }\item[{}]{name }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{        \textcolor{keywordflow}{case} state:\(\backslash\)}
\DoxyCodeLine{        PrintConsole(game, \textcolor{stringliteral}{"Resume \%s..."}, \#state); name \#\# \_Resume(game); \textcolor{keywordflow}{break};}

\end{DoxyCode}


Macro for invoking resume function of active gamestate. 

\mbox{\Hypertarget{main_8c_a914c1023fa675d05317561a3ba4270e9}\label{main_8c_a914c1023fa675d05317561a3ba4270e9}} 
\index{main.c@{main.c}!UNLOAD\_STATE@{UNLOAD\_STATE}}
\index{UNLOAD\_STATE@{UNLOAD\_STATE}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{UNLOAD\_STATE}{UNLOAD\_STATE}}
{\footnotesize\ttfamily \#define U\+N\+L\+O\+A\+D\+\_\+\+S\+T\+A\+TE(\begin{DoxyParamCaption}\item[{}]{state,  }\item[{}]{name }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{        \textcolor{keywordflow}{case} state:\(\backslash\)}
\DoxyCodeLine{        PrintConsole(game, \textcolor{stringliteral}{"Unload \%s..."}, \#state); name \#\# \_Unload(game); \textcolor{keywordflow}{break};}

\end{DoxyCode}


Macro for unloading gamestate. 

Unloading of state happens after it\textquotesingle{}s fadeout. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{main_8c_a3c3512cfd72e3078ed970085f31a7b40}\label{main_8c_a3c3512cfd72e3078ed970085f31a7b40}} 
\index{main.c@{main.c}!GetDataFilePath@{GetDataFilePath}}
\index{GetDataFilePath@{GetDataFilePath}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{GetDataFilePath()}{GetDataFilePath()}}
{\footnotesize\ttfamily char$\ast$ Get\+Data\+File\+Path (\begin{DoxyParamCaption}\item[{char $\ast$}]{filename }\end{DoxyParamCaption})}



Tries to figure out where are our assets currently stored. 

Finds path for data file.


\begin{DoxyParams}{Parameters}
{\em filename} & Filename from the assets directory independent of filesystem\\
\hline
\end{DoxyParams}
Tests against multiple possible paths for required file. If it won\textquotesingle{}t find any, exit(1) is called \begin{DoxyReturn}{Returns}
Duplicate string pointer to actual path of required file to be loaded or exit if not found 
\end{DoxyReturn}
\mbox{\Hypertarget{main_8c_a83e9560a39a8b6beea953f69553dd28b}\label{main_8c_a83e9560a39a8b6beea953f69553dd28b}} 
\index{main.c@{main.c}!PrintConsole@{PrintConsole}}
\index{PrintConsole@{PrintConsole}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{PrintConsole()}{PrintConsole()}}
{\footnotesize\ttfamily void Print\+Console (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structGame}{Game}} $\ast$}]{game,  }\item[{char $\ast$}]{format,  }\item[{}]{... }\end{DoxyParamCaption})}



Print some message on game console. 

Draws message on console bitmap, so it\textquotesingle{}ll be displayed when calling Draw\+Console. If game-\/$>$debug is true, then it also prints given message on stdout. It needs to be called in printf style. 